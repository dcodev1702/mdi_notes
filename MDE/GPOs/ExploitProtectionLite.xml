<?xml version="1.0" encoding="UTF-8"?>
<MitigationPolicy>
  <!-- SYSTEM-WIDE AUDIT SETTINGS -->
  <SystemConfig>
    <!-- SEHOP: Structured Exception Handler Overwrite Protection -->
    <SEHOP Audit="true" />
    
    <!-- Dynamic Code: Block unsigned dynamic code (DLL injection, code caves) -->
    <DynamicCode Audit="true" />
    
    <!-- Binary Signature: Require Microsoft-signed binaries -->
    <BinarySignature 
      AuditMicrosoftSignedOnly="true" 
      AuditStoreSigned="true"
      AuditEnforceModuleDependencySigning="true" 
    />
    
    <!-- Font Disable: Block untrusted font loading -->
    <FontDisable Audit="true" />
    
    <!-- Image Load: Block remote/low-integrity image loads -->
    <ImageLoad 
      AuditRemoteImageLoads="true" 
      AuditLowLabelImageLoads="true"
      AuditPreferSystem32="true"
    />
    
    <!-- System Call: Block Win32k and Fsctl system calls -->
    <SystemCall 
      Audit="true"
      AuditFsctlSystemCalls="true"
    />
    
    <!-- Child Process: Block child process creation -->
    <ChildProcess Audit="true" />
    
    <!-- User Shadow Stack: Hardware-enforced control flow integrity (CET) -->
    <UserShadowStack AuditUserShadowStack="true" />
    
    <!-- Payload: ROP and memory exploitation mitigations -->
    <Payload 
      AuditEnableExportAddressFilter="true"
      AuditEnableExportAddressFilterPlus="true"
      AuditEnableImportAddressFilter="true"
      AuditEnableRopStackPivot="true"
      AuditEnableRopCallerCheck="true"
      AuditEnableRopSimExec="true"
    />
  </SystemConfig>
  
  <!-- APPLICATION-SPECIFIC CONFIGURATIONS -->
  
  <!-- Internet Explorer -->
  <AppConfig Executable="iexplore.exe">
    <ImageLoad AuditRemoteImageLoads="true" />
    <Payload 
      AuditEnableExportAddressFilter="true"
      AuditEnableExportAddressFilterPlus="true"
      AuditEnableImportAddressFilter="true"
      AuditEnableRopStackPivot="true"
      AuditEnableRopCallerCheck="true"
      AuditEnableRopSimExec="true"
    />
  </AppConfig>
  
  <!-- Microsoft Edge (Legacy) -->
  <AppConfig Executable="MicrosoftEdge.exe">
    <ImageLoad AuditRemoteImageLoads="true" />
    <Payload 
      AuditEnableExportAddressFilter="true"
      AuditEnableExportAddressFilterPlus="true"
      AuditEnableImportAddressFilter="true"
      AuditEnableRopStackPivot="true"
      AuditEnableRopCallerCheck="true"
      AuditEnableRopSimExec="true"
    />
  </AppConfig>
  
  <!-- Microsoft Edge (Chromium) -->
  <AppConfig Executable="msedge.exe">
    <ImageLoad AuditRemoteImageLoads="true" />
    <Payload 
      AuditEnableExportAddressFilter="true"
      AuditEnableExportAddressFilterPlus="true"
      AuditEnableImportAddressFilter="true"
      AuditEnableRopStackPivot="true"
      AuditEnableRopCallerCheck="true"
      AuditEnableRopSimExec="true"
    />
  </AppConfig>
  
  <!-- Google Chrome -->
  <AppConfig Executable="chrome.exe">
    <ImageLoad AuditRemoteImageLoads="true" />
    <Payload 
      AuditEnableExportAddressFilter="true"
      AuditEnableExportAddressFilterPlus="true"
      AuditEnableImportAddressFilter="true"
      AuditEnableRopStackPivot="true"
      AuditEnableRopCallerCheck="true"
      AuditEnableRopSimExec="true"
    />
  </AppConfig>
  
  <!-- Mozilla Firefox -->
  <AppConfig Executable="firefox.exe">
    <ImageLoad AuditRemoteImageLoads="true" />
    <Payload 
      AuditEnableExportAddressFilter="true"
      AuditEnableExportAddressFilterPlus="true"
      AuditEnableImportAddressFilter="true"
      AuditEnableRopStackPivot="true"
      AuditEnableRopCallerCheck="true"
      AuditEnableRopSimExec="true"
    />
  </AppConfig>
  
  <!-- WordPad -->
  <AppConfig Executable="wordpad.exe">
    <DynamicCode Audit="true" />
    <BinarySignature 
      AuditMicrosoftSignedOnly="true" 
      AuditStoreSigned="true" 
    />
    <ImageLoad 
      AuditRemoteImageLoads="true"
      AuditLowLabelImageLoads="true"
    />
    <ChildProcess Audit="true" />
    <Payload 
      AuditEnableExportAddressFilter="true"
      AuditEnableExportAddressFilterPlus="true"
      AuditEnableImportAddressFilter="true"
      AuditEnableRopStackPivot="true"
      AuditEnableRopCallerCheck="true"
      AuditEnableRopSimExec="true"
    />
  </AppConfig>
  
  <!-- Notepad -->
  <AppConfig Executable="notepad.exe">
    <DynamicCode Audit="true" />
    <BinarySignature 
      AuditMicrosoftSignedOnly="true" 
      AuditStoreSigned="true" 
    />
    <ImageLoad 
      AuditRemoteImageLoads="true"
      AuditLowLabelImageLoads="true"
    />
    <ChildProcess Audit="true" />
    <Payload 
      AuditEnableExportAddressFilter="true"
      AuditEnableExportAddressFilterPlus="true"
      AuditEnableImportAddressFilter="true"
      AuditEnableRopStackPivot="true"
      AuditEnableRopCallerCheck="true"
      AuditEnableRopSimExec="true"
    />
  </AppConfig>
  
  <!-- Microsoft Outlook -->
  <AppConfig Executable="outlook.exe">
    <DynamicCode Audit="true" />
    <ImageLoad AuditRemoteImageLoads="true" />
    <ChildProcess Audit="true" />
    <Payload 
      AuditEnableExportAddressFilter="true"
      AuditEnableExportAddressFilterPlus="true"
      AuditEnableImportAddressFilter="true"
      AuditEnableRopStackPivot="true"
      AuditEnableRopCallerCheck="true"
      AuditEnableRopSimExec="true"
    />
  </AppConfig>
  
  <!-- Microsoft Word -->
  <AppConfig Executable="winword.exe">
    <DynamicCode Audit="true" />
    <ImageLoad AuditRemoteImageLoads="true" />
    <ChildProcess Audit="true" />
    <Payload 
      AuditEnableExportAddressFilter="true"
      AuditEnableExportAddressFilterPlus="true"
      AuditEnableImportAddressFilter="true"
      AuditEnableRopStackPivot="true"
      AuditEnableRopCallerCheck="true"
      AuditEnableRopSimExec="true"
    />
  </AppConfig>
  
  <!-- Microsoft Excel -->
  <AppConfig Executable="excel.exe">
    <DynamicCode Audit="true" />
    <ImageLoad AuditRemoteImageLoads="true" />
    <ChildProcess Audit="true" />
    <Payload 
      AuditEnableExportAddressFilter="true"
      AuditEnableExportAddressFilterPlus="true"
      AuditEnableImportAddressFilter="true"
      AuditEnableRopStackPivot="true"
      AuditEnableRopCallerCheck="true"
      AuditEnableRopSimExec="true"
    />
  </AppConfig>
  
  <!-- Microsoft PowerPoint -->
  <AppConfig Executable="powerpnt.exe">
    <DynamicCode Audit="true" />
    <ImageLoad AuditRemoteImageLoads="true" />
    <ChildProcess Audit="true" />
    <Payload 
      AuditEnableExportAddressFilter="true"
      AuditEnableExportAddressFilterPlus="true"
      AuditEnableImportAddressFilter="true"
      AuditEnableRopStackPivot="true"
      AuditEnableRopCallerCheck="true"
      AuditEnableRopSimExec="true"
    />
  </AppConfig>
  
  <!-- Adobe Acrobat Reader (32-bit) -->
  <AppConfig Executable="AcroRd32.exe">
    <DynamicCode Audit="true" />
    <ImageLoad AuditRemoteImageLoads="true" />
    <ChildProcess Audit="true" />
    <Payload 
      AuditEnableExportAddressFilter="true"
      AuditEnableExportAddressFilterPlus="true"
      AuditEnableImportAddressFilter="true"
      AuditEnableRopStackPivot="true"
      AuditEnableRopCallerCheck="true"
      AuditEnableRopSimExec="true"
    />
  </AppConfig>
  
  <!-- Adobe Acrobat -->
  <AppConfig Executable="Acrobat.exe">
    <DynamicCode Audit="true" />
    <ImageLoad AuditRemoteImageLoads="true" />
    <ChildProcess Audit="true" />
    <Payload 
      AuditEnableExportAddressFilter="true"
      AuditEnableExportAddressFilterPlus="true"
      AuditEnableImportAddressFilter="true"
      AuditEnableRopStackPivot="true"
      AuditEnableRopCallerCheck="true"
      AuditEnableRopSimExec="true"
    />
  </AppConfig>
  
  <!-- Adobe Reader DC -->
  <AppConfig Executable="AcroRd32.exe">
    <DynamicCode Audit="true" />
    <ImageLoad AuditRemoteImageLoads="true" />
    <ChildProcess Audit="true" />
    <Payload 
      AuditEnableExportAddressFilter="true"
      AuditEnableExportAddressFilterPlus="true"
      AuditEnableImportAddressFilter="true"
      AuditEnableRopStackPivot="true"
      AuditEnableRopCallerCheck="true"
      AuditEnableRopSimExec="true"
    />
  </AppConfig>
  
  <!-- Flash Loader -->
  <AppConfig Executable="fltldr.exe">
    <DynamicCode Audit="true" />
    <ImageLoad AuditRemoteImageLoads="true" />
    <ChildProcess Audit="true" />
    <Payload 
      AuditEnableExportAddressFilter="true"
      AuditEnableExportAddressFilterPlus="true"
      AuditEnableImportAddressFilter="true"
      AuditEnableRopStackPivot="true"
      AuditEnableRopCallerCheck="true"
      AuditEnableRopSimExec="true"
    />
  </AppConfig>
  
  <!-- Runtime Broker -->
  <AppConfig Executable="RuntimeBroker.exe">
    <ImageLoad AuditRemoteImageLoads="true" />
    <Payload 
      AuditEnableExportAddressFilter="true"
      AuditEnableExportAddressFilterPlus="true"
      AuditEnableImportAddressFilter="true"
      AuditEnableRopStackPivot="true"
      AuditEnableRopCallerCheck="true"
      AuditEnableRopSimExec="true"
    />
  </AppConfig>
  
  <!-- Windows Search Indexer -->
  <AppConfig Executable="SearchIndexer.exe">
    <DynamicCode Audit="true" />
    <BinarySignature 
      AuditMicrosoftSignedOnly="true" 
      AuditStoreSigned="true" 
    />
    <Payload 
      AuditEnableExportAddressFilter="true"
      AuditEnableExportAddressFilterPlus="true"
      AuditEnableImportAddressFilter="true"
      AuditEnableRopStackPivot="true"
      AuditEnableRopCallerCheck="true"
      AuditEnableRopSimExec="true"
    />
  </AppConfig>
  
  <!-- Java -->
  <AppConfig Executable="java.exe">
    <DynamicCode Audit="true" />
    <ImageLoad AuditRemoteImageLoads="true" />
    <ChildProcess Audit="true" />
    <Payload 
      AuditEnableExportAddressFilter="true"
      AuditEnableExportAddressFilterPlus="true"
      AuditEnableImportAddressFilter="true"
      AuditEnableRopStackPivot="true"
      AuditEnableRopCallerCheck="true"
      AuditEnableRopSimExec="true"
    />
  </AppConfig>
  
  <!-- Java Web Start -->
  <AppConfig Executable="javaws.exe">
    <DynamicCode Audit="true" />
    <ImageLoad AuditRemoteImageLoads="true" />
    <ChildProcess Audit="true" />
    <Payload 
      AuditEnableExportAddressFilter="true"
      AuditEnableExportAddressFilterPlus="true"
      AuditEnableImportAddressFilter="true"
      AuditEnableRopStackPivot="true"
      AuditEnableRopCallerCheck="true"
      AuditEnableRopSimExec="true"
    />
  </AppConfig>
  
  <!-- Java (Window mode) -->
  <AppConfig Executable="javaw.exe">
    <DynamicCode Audit="true" />
    <ImageLoad AuditRemoteImageLoads="true" />
    <ChildProcess Audit="true" />
    <Payload 
      AuditEnableExportAddressFilter="true"
      AuditEnableExportAddressFilterPlus="true"
      AuditEnableImportAddressFilter="true"
      AuditEnableRopStackPivot="true"
      AuditEnableRopCallerCheck="true"
      AuditEnableRopSimExec="true"
    />
  </AppConfig>
  
  <!-- PowerShell -->
  <AppConfig Executable="powershell.exe">
    <DynamicCode Audit="true" />
    <ImageLoad AuditRemoteImageLoads="true" />
    <ChildProcess Audit="true" />
    <Payload 
      AuditEnableExportAddressFilter="true"
      AuditEnableExportAddressFilterPlus="true"
      AuditEnableImportAddressFilter="true"
      AuditEnableRopStackPivot="true"
      AuditEnableRopCallerCheck="true"
      AuditEnableRopSimExec="true"
    />
  </AppConfig>
  
  <!-- PowerShell Core -->
  <AppConfig Executable="pwsh.exe">
    <DynamicCode Audit="true" />
    <ImageLoad AuditRemoteImageLoads="true" />
    <ChildProcess Audit="true" />
    <Payload 
      AuditEnableExportAddressFilter="true"
      AuditEnableExportAddressFilterPlus="true"
      AuditEnableImportAddressFilter="true"
      AuditEnableRopStackPivot="true"
      AuditEnableRopCallerCheck="true"
      AuditEnableRopSimExec="true"
    />
  </AppConfig>
  
  <!-- Command Prompt -->
  <AppConfig Executable="cmd.exe">
    <DynamicCode Audit="true" />
    <ImageLoad AuditRemoteImageLoads="true" />
    <ChildProcess Audit="true" />
    <Payload 
      AuditEnableExportAddressFilter="true"
      AuditEnableExportAddressFilterPlus="true"
      AuditEnableImportAddressFilter="true"
      AuditEnableRopStackPivot="true"
      AuditEnableRopCallerCheck="true"
      AuditEnableRopSimExec="true"
    />
  </AppConfig>
  
  <!-- Windows Script Host -->
  <AppConfig Executable="wscript.exe">
    <DynamicCode Audit="true" />
    <ImageLoad AuditRemoteImageLoads="true" />
    <ChildProcess Audit="true" />
    <Payload 
      AuditEnableExportAddressFilter="true"
      AuditEnableExportAddressFilterPlus="true"
      AuditEnableImportAddressFilter="true"
      AuditEnableRopStackPivot="true"
      AuditEnableRopCallerCheck="true"
      AuditEnableRopSimExec="true"
    />
  </AppConfig>
  
  <!-- Console Script Host -->
  <AppConfig Executable="cscript.exe">
    <DynamicCode Audit="true" />
    <ImageLoad AuditRemoteImageLoads="true" />
    <ChildProcess Audit="true" />
    <Payload 
      AuditEnableExportAddressFilter="true"
      AuditEnableExportAddressFilterPlus="true"
      AuditEnableImportAddressFilter="true"
      AuditEnableRopStackPivot="true"
      AuditEnableRopCallerCheck="true"
      AuditEnableRopSimExec="true"
    />
  </AppConfig>
  
  <!-- Endpoint Self-host -->
  <AppConfig Executable="EpSelfhostV1.exe">
    <DynamicCode Audit="true" />
    <ImageLoad AuditRemoteImageLoads="true" />
    <ChildProcess Audit="true" />
    <Payload 
      AuditEnableExportAddressFilter="true"
      AuditEnableExportAddressFilterPlus="true"
      AuditEnableImportAddressFilter="true"
      AuditEnableRopStackPivot="true"
      AuditEnableRopCallerCheck="true"
      AuditEnableRopSimExec="true"
    />
  </AppConfig>
</MitigationPolicy>
